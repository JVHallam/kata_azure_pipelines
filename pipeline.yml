pool:
  name : linux

variables:
- name: one
  value: initialValue 

stages:
- stage: first
  jobs:
  - job: run
    steps:
    - task : Bash@3
      inputs : 
        targetType : "inline"
        script : |
          echo ${{ variables.one }} # outputs initialValue
          echo $(one)

    - task : Bash@3
      name : fatbutt
      inputs : 
        targetType : "inline"
        script : |
          echo "Editing the value"
          echo '##vso[task.setvariable variable=one]secondValue'
          echo '##vso[task.setvariable variable=myOutputVar;isOutput=true]newValue'

    - task : Bash@3
      inputs : 
        targetType : "inline"
        script : |
          echo ${{ variables.one }} # outputs initialValue
          echo $(one) #outputs secondValue
          echo $(fatbutt.myOutputVar)

  - job: check
    steps:
    - task : Bash@3
      inputs : 
        targetType : "inline"
        script : |
          # Try and get this to be secondValue
          echo $(one) # outputs initialValue
          echo $(fatbutt.myOutputVar) #This should be nothing, until we introduce dependencies

- stage: second
  jobs:
  - job: check
    steps:
    - task : Bash@3
      inputs : 
        targetType : "inline"
        script : |
          echo $(one)# outputs initialValue
